sudo: false
dist: trusty
language: python
python:
  - "3.4"
  - "3.5"
  - "3.6"

addons:
  apt:
    packages:
      - google-chrome-stable

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3
  - wget https://chromedriver.storage.googleapis.com/2.29/chromedriver_linux64.zip
  - unzip chromedriver_linux64.zip -d ${TRAVIS_BUILD_DIR}

install:
  - pip install tox
  - pip install selenium nose_parameterized syncer coverage tornado
  - if [[ $TRAVIS_PYTHON_VERSION == 3.4* ]]; then pip install mypy; fi
  - if [[ $TRAVIS_PYTHON_VERSION == 3.6* ]]; then pip install codecov coveralls; fi
script:
  - tox -c tox_travis.ini
  - coverage erase
  - make clean
  - PYTHONPATH=${TRAVIS_BUILD_DIR} python -m coverage run --source wdom tests/run_tests.py
  - coverage report
after_success:
  - if [[ $TRAVIS_PYTHON_VERSION == 3.6* ]]; then codecov -b $TRAVIS_BRANCH && coveralls; fi
